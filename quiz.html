<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Physics Cycle - MCQ Quiz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Extra quiz styling only for this page */
    .btn-secondary {
      background: #6b7280;
      box-shadow: none;
    }
    .btn-secondary:hover {
      background: #4b5563;
    }

    .quiz-option {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.35rem 0.6rem;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      cursor: pointer;
      font-size: 0.9rem;
      background: #f9fafb;
    }
    .quiz-option input {
      accent-color: #2563eb;
    }

    #quiz-feedback {
      margin-top: 0.6rem;
      font-size: 0.9rem;
      padding: 0.4rem 0.6rem;
      border-radius: 8px;
      display: none;
    }
    #quiz-feedback.correct {
      display: block;
      background: #dcfce7;
      color: #166534;
      border: 1px solid #16a34a;
    }
    #quiz-feedback.incorrect {
      display: block;
      background: #fee2e2;
      color: #b91c1c;
      border: 1px solid #ef4444;
    }
    #quiz-feedback.info {
      display: block;
      background: #e0f2fe;
      color: #0ea5e9;
      border: 1px solid #38bdf8;
    }

    #final-summary {
      margin-top: 0.6rem;
      font-size: 0.9rem;
      padding: 0.4rem 0.6rem;
      border-radius: 8px;
      background: #eef2ff;
      color: #4338ca;
      border: 1px solid #a5b4fc;
      display: none;
    }

    .coming-soon-text {
      font-size: 0.9rem;
      color: #6b7280;
      margin-top: 0.4rem;
    }

    .btn.coming-soon {
      background: #9ca3af;
      box-shadow: none;
      cursor: not-allowed;
    }
    .btn.coming-soon:hover {
      background: #9ca3af;
      transform: none;
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="header-inner">
      <div class="logo">Physics Cycle</div>
      <nav class="nav-links">
        <a href="index.html" class="nav-link">Home</a>
        <a href="branches.html" class="nav-link">Notes</a>
        <a href="quiz.html" class="nav-link active">Quiz</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="page-header">
      <div class="page-title-block">
        <h1 class="page-title">MCQ Quiz</h1>
        <p class="page-subtitle">
          Choose a subject and unit. Questions appear in random order, 10 at a time. For each question, click "Answer" to see if you're right. After 10 questions, you'll see your score and can continue until all questions are done.
        </p>
      </div>
    </section>

    <!-- 1. SUBJECT SELECTION -->
    <section>
      <h2 style="font-size:1rem;margin-bottom:0.5rem;">1. Choose a subject</h2>
      <div id="quiz-subject-buttons" class="subjects-buttons semester-buttons">
        <!-- JS will insert subject buttons -->
      </div>
    </section>

    <!-- 2. UNIT SELECTION -->
    <section style="margin-top:1.5rem;">
      <h2 style="font-size:1rem;margin-bottom:0.5rem;">2. Choose a unit</h2>
      <div id="quiz-unit-buttons" class="subjects-buttons">
        <p id="unit-placeholder" style="font-size:0.9rem;color:#6b7280;">
          Select a subject first.
        </p>
      </div>
      <p id="coming-soon-subject" class="coming-soon-text hidden"></p>
    </section>

    <!-- 3. QUESTION CARD -->
    <section id="quiz-card" class="card hidden" style="margin-top:1.5rem;">
      <div class="card-header-row">
        <h2 id="quiz-title" class="card-title"></h2>
        <span id="quiz-progress" class="branch-code"></span>
      </div>
      <p id="quiz-unit-label" class="card-desc"></p>

      <div id="question-block" style="margin-top:0.75rem;">
        <p id="question-text" style="font-weight:500;margin-bottom:0.5rem;"></p>
        <div id="options-container"
             style="display:flex;flex-direction:column;gap:0.4rem;"></div>
      </div>

      <div id="quiz-feedback"></div>
      <div id="final-summary"></div>

      <div style="display:flex;justify-content:flex-end;align-items:center;margin-top:1rem;gap:0.5rem;flex-wrap:wrap;">
        <button id="check-btn" class="btn" type="button">
          Answer
        </button>
        <button id="next-btn" class="btn btn-secondary" type="button" style="display:none;">
          Next Question
        </button>
        <button id="next-set-btn" class="btn btn-secondary" type="button" style="display:none;">
          Next 10 Questions
        </button>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <p>&copy; 2025 Physics Cycle • By Sujanraj. All rights reserved.</p>
  </footer>

  <script>
    // =========================
    //  QUIZ DATA
    // =========================

    const quizData = {
      "PSP": {
        "Unit 2: Quantum Computing": [
          {
            text: "In quantum computing, what is the basic unit of information?",
            options: ["Giga", "Qubit", "Bit", "Byte"],
            correctIndex: 1
          },
          {
            text: "What do we call the pieces of information in a quantum computer?",
            options: ["Bits", "Qubits", "Bytes", "Qubytes"],
            correctIndex: 1
          },
          {
            text: "When the information is between 0 and 1 in a quantum computer, what do we call this?",
            options: ["Superposition", "Same position", "Ordinary position", "Different position"],
            correctIndex: 0
          },
          {
            text: "Quantum computers are very good at dealing with",
            options: ["Clarity", "Certainty", "Uncertainty", "Reliability"],
            correctIndex: 2
          },
          {
            text: "What does 'entanglement' mean?",
            options: [
              "Two particles are different",
              "Two particles are separate",
              "Two particles are independent",
              "Two particles are connected"
            ],
            correctIndex: 3
          },
          {
            text: "What can quantum computers be used for?",
            options: [
              "Artificial Intelligence",
              "Simulations/Predictions",
              "Both (A) and (B)",
              "Google Docs and Slides"
            ],
            correctIndex: 2
          },
          {
            text: "When the two members of a qubit pair exist in a single quantum state, it is known as",
            options: ["Entanglement", "Engagement", "Superposition", "None of the above"],
            correctIndex: 0
          },
          {
            text: "Quantum computing is relatively _________ than classical computing.",
            options: ["Faster", "Slower", "Average", "None of the above"],
            correctIndex: 0
          },
          {
            text: "Qubit stands for",
            options: ["Quality bits", "Question bit", "Quantum gates", "Quantum bit"],
            correctIndex: 3
          },
          {
            text: "A qubit is a _______ quantum-mechanical system.",
            options: ["One-state", "Two-state", "Three-state", "Four-state"],
            correctIndex: 1
          },
          {
            text: "The set of vectors and scalars following linear vector-space properties is called",
            options: ["Basis", "Dimension", "Hilbert space", "Orthogonal state"],
            correctIndex: 2
          },
          {
            text: "Replacing the i-th row of a matrix by the i-th column gives the",
            options: ["Conjugate matrix", "Transpose matrix", "Identity matrix", "Hermitian operator"],
            correctIndex: 1
          },
          {
            text: "Operators change with time while state vectors remain constant. This is",
            options: [
              "Schrodinger representation",
              "Heisenberg representation",
              "Interaction representation",
              "None of the above"
            ],
            correctIndex: 1
          },
          {
            text: "Operators remain constant while state vectors change with time. This is",
            options: [
              "Schrodinger representation",
              "Heisenberg representation",
              "Interaction representation",
              "None of the above"
            ],
            correctIndex: 0
          },
          {
            text: "The diagonal entries of a Hermitian matrix must be",
            options: ["Complex conjugate", "Real", "Both real and complex", "None of the above"],
            correctIndex: 1
          },
          {
            text: "Eigenvalues of a Hermitian matrix must be",
            options: ["Complex conjugate", "Real", "Both real and complex", "None of the above"],
            correctIndex: 1
          },
          {
            text: "What is a vector space?",
            options: [
              "A space consisting of only vectors",
              "A set of vectors closed under addition and scalar multiplication",
              "A space including both vectors and scalars",
              "A space that is always three-dimensional"
            ],
            correctIndex: 1
          },
          {
            text: "What is the dimension of a vector space?",
            options: [
              "The size or length of a vector",
              "The number of vectors in the space",
              "The maximum number of linearly independent vectors that span the space",
              "The number of elements in a basis"
            ],
            correctIndex: 2
          },
          {
            text: "What is the span of a set of vectors?",
            options: [
              "The set of all vectors in the vector space",
              "The set of all linear combinations of the vectors",
              "The set of vectors orthogonal to the given set",
              "The set of linearly independent vectors"
            ],
            correctIndex: 1
          },
          {
            text: "In a finite-dimensional vector space, the maximum number of linearly independent vectors a basis can have is",
            options: ["0", "1", "The dimension of the space", "The size of the space"],
            correctIndex: 2
          },
          {
            text: "Moore's Law originally stated that the number of transistors on a microchip would double approximately every",
            options: ["6 months", "1 year", "2 years", "5 years"],
            correctIndex: 2
          },
          {
            text: "Which trend enabled Moore's Law for decades?",
            options: [
              "Miniaturization of transistors",
              "Increase in clock speed",
              "Expansion of data storage",
              "Advances in software algorithms"
            ],
            correctIndex: 0
          },
          {
            text: "Which component is primarily affected by Moore's Law?",
            options: [
              "CPU",
              "RAM",
              "Hard disk drive",
              "GPU"
            ],
            correctIndex: 0
          },
          {
            text: "A main factor contributing to the end of Moore's Law is",
            options: [
              "Decreased demand for computing power",
              "Physical limits of miniaturization",
              "Lack of software innovation",
              "Cost of semiconductors"
            ],
            correctIndex: 1
          },
          {
            text: "Which approaches are being explored beyond Moore's Law?",
            options: [
              "Quantum computing",
              "Neuromorphic computing",
              "Optical computing",
              "All of these"
            ],
            correctIndex: 3
          },
          {
            text: "What is the fundamental unit of information in quantum computing?",
            options: ["Bit", "Byte", "Qubit", "Quantum gate"],
            correctIndex: 2
          },
          {
            text: "In classical computing, a bit can have values",
            options: ["0 and 1", "True and False", "-1 and 1", "Red and Blue"],
            correctIndex: 0
          },
          {
            text: "Which property allows qubits to represent multiple states simultaneously?",
            options: ["Superposition", "Entanglement", "Interference", "Tunnelling"],
            correctIndex: 0
          },
          {
            text: "In a CNOT gate, you create a(n) ______ with two qubits.",
            options: ["Superposition", "Entangled state", "Bloch", "Hadamard"],
            correctIndex: 1
          },
          {
            text: "In a quantum circuit, which gate is used to place a qubit into superposition?",
            options: ["Hadamard", "X-gate", "Bloch", "CNOT"],
            correctIndex: 0
          },
          {
            text: "Which quantum gate is most similar to a classical NOT gate?",
            options: ["CNOT", "X-gate", "Hadamard", "Deutsch gate"],
            correctIndex: 1
          },
          {
            text: "What is superposition in quantum computing?",
            options: [
              "A state where a qubit can exist in multiple states at once",
              "The process of entangling multiple qubits",
              "A gate used to manipulate qubits",
              "A unit of quantum information"
            ],
            correctIndex: 0
          },
          {
            text: "What happens to entanglement when qubits are physically separated?",
            options: [
              "Entanglement is lost",
              "Entanglement remains intact",
              "Entanglement becomes stronger",
              "Entanglement becomes weaker"
            ],
            correctIndex: 1
          },
          {
            text: "What is the main purpose of quantum gates?",
            options: [
              "To entangle qubits",
              "To collapse superposition",
              "To manipulate qubits",
              "To measure qubit states"
            ],
            correctIndex: 2
          }
        ]
      },

      "Physics": {
        "Unit 1: Quantum Mechanics": [
          {
            text: "An experimental evidence for matter waves is",
            options: [
              "Photoelectric effect",
              "Compton effect",
              "Electron diffraction",
              "Interference of light"
            ],
            correctIndex: 2
          },
          {
            text: "A wave packet is used to represent",
            options: [
              "A light wave",
              "A stationary wave",
              "Matter wave",
              "A transverse wave"
            ],
            correctIndex: 2
          },
          {
            text: "Wave function associated with matter waves is a quantum mechanical equivalent of",
            options: [
              "Wavelength of the wave",
              "Frequency of the wave",
              "Amplitude of the wave",
              "Phase of the wave"
            ],
            correctIndex: 2
          },
          {
            text: "The concept of matter wave was suggested by",
            options: [
              "Heisenberg",
              "de Broglie",
              "Schrodinger",
              "Laplace"
            ],
            correctIndex: 1
          },
          {
            text: "The function representing matter waves must be",
            options: [
              "Complex",
              "Real",
              "Zero",
              "Infinity"
            ],
            correctIndex: 0
          },
          {
            text: "A particle with rest mass m₀ is moving with speed c. The de Broglie wavelength associated with it is",
            options: [
              "Zero",
              "Infinity",
              "hγ/c²",
              "m₀c"
            ],
            correctIndex: 0
          },
          {
            text: "The matter waves are",
            options: [
              "Light waves",
              "Sound waves",
              "Probabilistic waves",
              "Electromagnetic waves"
            ],
            correctIndex: 2
          },
          {
            text: "The wavelength of matter waves does not depend on",
            options: [
              "Charge",
              "Mass",
              "Velocity",
              "Momentum"
            ],
            correctIndex: 0
          },
          {
            text: "de Broglie wavelength of a body of mass m and kinetic energy E is",
            options: [
              "λ = h/p",
              "λ = h/meV",
              "λ = h/√(2mE)",
              "λ = h/2meV"
            ],
            correctIndex: 2
          },
          {
            text: "If the energy of a particle is reduced to one-fourth, the percentage increase in the de Broglie wavelength is",
            options: [
              "41%",
              "100%",
              "144%",
              "70%"
            ],
            correctIndex: 1
          },
          {
            text: "The kinetic energy of electron and proton is the same. The relation between their de Broglie wavelengths λₑ and λₚ is",
            options: [
              "λₑ = λₚ",
              "λₑ < λₚ",
              "λₑ > λₚ",
              "λₑ = 2λₚ"
            ],
            correctIndex: 2
          },
          {
            text: "The wave nature associated with electrons in motion was verified by",
            options: [
              "Photoelectric effect",
              "Compton effect",
              "Diffraction by crystals",
              "Incidence of electrons on metallic surface"
            ],
            correctIndex: 2
          },
          {
            text: "________ of a wave is the velocity with which the envelope (modulation) propagates through space.",
            options: [
              "Elliptical velocity",
              "Phase velocity",
              "Group velocity",
              "Circular velocity"
            ],
            correctIndex: 2
          },
          {
            text: "The phase and group velocities do not depend on which of the following?",
            options: [
              "Frequency",
              "Wavelength",
              "Phase constant",
              "Attenuation constant"
            ],
            correctIndex: 3
          },
          {
            text: "de Broglie wavelength can be assigned to",
            options: [
              "Only electrons",
              "Any stationary body",
              "Any moving body",
              "Only subatomic particles"
            ],
            correctIndex: 2
          },
          {
            text: "Which one of the following objects, moving at the same speed, has the greatest de Broglie wavelength?",
            options: [
              "Neutron",
              "Electron",
              "Tennis ball",
              "Football"
            ],
            correctIndex: 1
          },
          {
            text: "The group velocity of matter waves associated with a moving particle is",
            options: [
              "The same as phase velocity",
              "Less than the particle velocity",
              "Equal to the particle velocity",
              "More than the particle velocity"
            ],
            correctIndex: 2
          },
          {
            text: "Uncertainty principle is applicable to",
            options: [
              "Macroscopic particles",
              "Microscopic particles",
              "Gases",
              "None of these"
            ],
            correctIndex: 1
          },
          {
            text: "According to Heisenberg uncertainty principle",
            options: [
              "E = mc²",
              "Δx·Δp ≥ h/4π",
              "λ = h/p",
              "Δx·Δp = h/6π"
            ],
            correctIndex: 1
          },
          {
            text: "If uncertainty in the position of an electron is zero, the uncertainty in its momentum would be",
            options: [
              "Zero",
              "< h/2λ",
              "> h/2λ",
              "Infinite"
            ],
            correctIndex: 3
          },
          {
            text: "How is the state of a quantum mechanical system completely specified?",
            options: [
              "By its position in space",
              "By its time",
              "By its wavefunction",
              "By its angular momentum"
            ],
            correctIndex: 2
          },
          {
            text: "The wave function is acceptable if it is",
            options: [
              "Finite everywhere",
              "Continuous everywhere",
              "Single-valued everywhere",
              "All of these"
            ],
            correctIndex: 3
          },
          {
            text: "Schrodinger’s time-independent equation is applicable for particles with",
            options: [
              "Constant energy",
              "Variable energy",
              "Only constant potential energy",
              "All of these"
            ],
            correctIndex: 0
          },
          {
            text: "The steady-state form of Schrodinger wave equation is",
            options: [
              "Linear",
              "Quadratic",
              "Cubic",
              "Nonlinear"
            ],
            correctIndex: 0
          },
          {
            text: "The values of energy for which Schrodinger’s steady-state equation can be solved are called",
            options: [
              "Eigen vectors",
              "Eigen values",
              "Eigen functions",
              "Operators"
            ],
            correctIndex: 1
          },
          {
            text: "The Schrodinger wave equation is a",
            options: [
              "Linear differential equation",
              "Non-linear differential equation",
              "Second-order equation",
              "First-order equation"
            ],
            correctIndex: 0
          },
          {
            text: "For a quantum wave particle, E =",
            options: [
              "ℏk",
              "ℏω",
              "ℏω/2",
              "ℏk/2"
            ],
            correctIndex: 1
          },
          {
            text: "Which of the following can be a wave function?",
            options: [
              "tan x",
              "sin x",
              "cot x",
              "sec x"
            ],
            correctIndex: 1
          },
          {
            text: "Which of the following is NOT a characteristic of a wave function?",
            options: [
              "Continuous",
              "Single-valued",
              "Normalizable",
              "Multi-valued"
            ],
            correctIndex: 3
          },
          {
            text: "The total probability of finding the particle in space must be",
            options: [
              "Zero",
              "Unity",
              "Infinity",
              "Double"
            ],
            correctIndex: 1
          },
          {
            text: "The normalized wave function must have ______ norm.",
            options: [
              "Unit",
              "Zero",
              "Finite",
              "Infinite"
            ],
            correctIndex: 0
          },
          {
            text: "The square of the magnitude of the wave function is called",
            options: [
              "Current density",
              "Probability density",
              "Normalization",
              "Volume density"
            ],
            correctIndex: 1
          },
          {
            text: "ψ and its first derivative should be ______ functions of x.",
            options: [
              "Zero",
              "Continuous",
              "Infinite",
              "Discontinuous"
            ],
            correctIndex: 1
          },
          {
            text: "For E > 0, the particle has ______ kinetic energy.",
            options: [
              "Zero",
              "Positive",
              "Negative",
              "Infinite"
            ],
            correctIndex: 1
          },
          {
            text: "According to Max Born’s interpretation, |ψ|² represents",
            options: [
              "Energy density",
              "Particle density",
              "Probability density",
              "Charge density"
            ],
            correctIndex: 2
          },
          {
            text: "In a one-dimensional infinite potential well, the energy of the particle is En =",
            options: [
              "n²h²/8mL²",
              "n²ℏ²/8mL²",
              "n²h²/2mL²",
              "n²h²/4mL²"
            ],
            correctIndex: 0
          },
          {
            text: "The lowest permitted energy level for a particle in an infinite potential well is called",
            options: [
              "Excited energy",
              "Zero-point energy",
              "Metastable energy",
              "None of these"
            ],
            correctIndex: 1
          },
          {
            text: "For a particle in the ground state in an infinite potential well of width L, the probability is maximum at",
            options: [
              "L/2 from the wall",
              "L/4 from the wall",
              "3L/4 from the wall",
              "At x = 0"
            ],
            correctIndex: 0
          },
          {
            text: "For a particle in a box, the wave function lies in the region",
            options: [
              "x > 0",
              "x < 0",
              "0 < x < L",
              "x > L"
            ],
            correctIndex: 2
          },
          {
            text: "The energy of the particle in an infinite potential well is proportional to",
            options: [
              "n",
              "1/n",
              "n²",
              "1/n²"
            ],
            correctIndex: 2
          },
          {
            text: "The wave function with one node in an infinite potential well corresponds to",
            options: [
              "Ground state",
              "First excited state",
              "Second excited state",
              "Third excited state"
            ],
            correctIndex: 1
          },
          {
            text: "The de Broglie wavelength of a particle of mass 6.62×10⁻²⁹ kg moving at 10⁵ m/s is",
            options: [
              "10 nm",
              "1 nm",
              "0.1 nm",
              "0.01 nm"
            ],
            correctIndex: 2
          },
          {
            text: "The energy of an electron in terms of its ground state energy E₁ when it jumps from n = 1 to n = 4 is",
            options: [
              "E₁/9",
              "E₁/16",
              "16E₁",
              "4E₁"
            ],
            correctIndex: 2
          },
          {
            text: "An electron trapped in a 1 Å-wide infinite well: energy required to excite from ground to second excited state is",
            options: [
              "4.82×10⁻¹⁷ J",
              "4.82×10⁻¹⁸ J",
              "1.81×10⁻¹⁷ J",
              "1.81×10⁻¹⁸ J"
            ],
            correctIndex: 0
          },
          {
            text: "The de Broglie wavelength of an electron with kinetic energy 2000 eV is",
            options: [
              "2.74 Å",
              "0.274 Å",
              "27.4 Å",
              "0.0274 Å"
            ],
            correctIndex: 1
          },
          {
            text: "The product of phase velocity and group velocity equals the",
            options: [
              "Particle velocity",
              "Velocity of light",
              "Square of velocity of light",
              "Square root of velocity of light"
            ],
            correctIndex: 2
          },
          {
            text: "Zero-point energy for an electron confined to a 1 nm box is about",
            options: [
              "3.9×10⁻²⁹ J",
              "4.9×10⁻²⁹ J",
              "5.9×10⁻²⁹ J",
              "6.9×10⁻²⁹ J"
            ],
            correctIndex: 2
          },
          {
            text: "The de Broglie wavelength of an electron moving at 10⁵ m/s is",
            options: [
              "0.727 Å",
              "7.27 Å",
              "72.7 Å",
              "727 Å"
            ],
            correctIndex: 2
          },
          {
            text: "The ratio of energy of a photon to that of a neutron when both have wavelength 1 Å (mₙ = 1.678×10⁻²⁷ kg) is",
            options: [
              "2.5×10⁵",
              "1.5×10⁵",
              "0.5×10⁵",
              "3.5×10⁵"
            ],
            correctIndex: 1
          },
          {
            text: "An electron confined between two rigid walls separated by 20 Å. The de Broglie wavelength for ground state energy is",
            options: [
              "0.6 Å",
              "0.2 Å",
              "0.4 Å",
              "0.8 Å"
            ],
            correctIndex: 2
          }
        ],

        "Unit 3: Conductors and Superconductors": [
          {
            text: "Which statement correctly describes a metal based on band theory?",
            options: [
              "A material with moderate band gap",
              "A material with large band gap",
              "A material with zero band gap",
              "A material with infinite band gap"
            ],
            correctIndex: 2
          },
          {
            text: "Solids with high value of conductivity are called",
            options: [
              "Conductors",
              "Non-metal",
              "Insulator",
              "Semi-conductor"
            ],
            correctIndex: 0
          },
          {
            text: "The electrons in valence band are",
            options: [
              "Freely moving inside the solid",
              "Tightly bonded inside the solid",
              "In innermost orbits and cannot be freed",
              "In outermost orbits and cannot be freed"
            ],
            correctIndex: 0
          },
          {
            text: "Fermi level for a metal is",
            options: [
              "Highest energy level occupied at 0°C",
              "Average of all available energy levels",
              "Highest energy level occupied at 0 K",
              "Sum of energies of all electron levels"
            ],
            correctIndex: 2
          },
          {
            text: "Free electron theory could not explain",
            options: [
              "Electrical and thermal conductivity of metals",
              "Thermal conductivity of non-metals",
              "Ferromagnetism",
              "Ohm’s law"
            ],
            correctIndex: 2
          },
          {
            text: "Free electron theory assumes",
            options: [
              "Electrons move freely only at center",
              "Electrons move freely throughout the solid",
              "Electrons move freely only on top surface",
              "Electrons move freely only on bottom surface"
            ],
            correctIndex: 1
          },
          {
            text: "As temperature increases, conductivity of metals",
            options: [
              "Increases",
              "Decreases",
              "Does not change",
              "Increases with √T"
            ],
            correctIndex: 1
          },
          {
            text: "Mobility of electron is",
            options: [
              "Average flow of electrons per unit electric field",
              "Average field per unit drift velocity",
              "Average drift velocity per unit electric field",
              "1/(conductivity × charge)"
            ],
            correctIndex: 2
          },
          {
            text: "Flow of electrons is affected by",
            options: [
              "Thermal vibrations",
              "Impurity atoms",
              "Crystal defects",
              "All of these"
            ],
            correctIndex: 3
          },
          {
            text: "Classically, resistivity ρ varies with temperature T as",
            options: [
              "ρ ∝ T",
              "ρ ∝ 1/T",
              "ρ ∝ T¹ᐟ³",
              "ρ ∝ T²"
            ],
            correctIndex: 0
          },
          {
            text: "In Matthiessen’s rule ρtot = ρphon + ρ₀, which is true?",
            options: [
              "ρphon is temperature dependent",
              "ρ₀ is temperature dependent",
              "ρ₀ is due to lattice vibrations",
              "None of these"
            ],
            correctIndex: 0
          },
          {
            text: "Relaxation time is the time taken for electron velocity to reduce to ______ of its initial value.",
            options: [
              "1/2",
              "1/3",
              "1/e",
              "1/2e"
            ],
            correctIndex: 2
          },
          {
            text: "Average distance travelled by a free electron between collisions with lattice ions is",
            options: [
              "Mean free path",
              "Free path",
              "Drift velocity",
              "Mean collision time"
            ],
            correctIndex: 0
          },
          {
            text: "According to Pauli’s exclusion principle, an energy level can have at most",
            options: [
              "One electron",
              "Two electrons",
              "Three electrons",
              "Four electrons"
            ],
            correctIndex: 1
          },
          {
            text: "Relation between current density J and electric field E is",
            options: [
              "J = σE",
              "J = σ/E",
              "J = σ/2E",
              "J = (1/σ)E"
            ],
            correctIndex: 0
          },
          {
            text: "Drift velocity is given by",
            options: [
              "v_d = eEτ/m",
              "v_d = Eτ/m",
              "v_d = eτ/m",
              "v_d = eE/n"
            ],
            correctIndex: 0
          },
          {
            text: "Which is correct about classical free electron theory?",
            options: [
              "Free electrons are responsible for metallic conductivity",
              "Semiconductors can be explained properly",
              "Insulators can be explained properly",
              "Ohm’s law cannot be derived"
            ],
            correctIndex: 0
          },
          {
            text: "According to free electron theory",
            options: [
              "Valence electrons are tightly bound",
              "Valence electrons are weakly bound",
              "No free electrons in metal",
              "Some valence electrons weakly bound, some tightly bound"
            ],
            correctIndex: 1
          },
          {
            text: "About free electrons in metals:",
            options: [
              "Valence electrons move throughout the material",
              "Valence electrons do not move",
              "Bound electrons move throughout the material",
              "All electrons move throughout the material"
            ],
            correctIndex: 0
          },
          {
            text: "Electrons in conductors obey",
            options: [
              "Bose–Einstein distribution",
              "Fermi–Dirac distribution",
              "Maxwell–Boltzmann distribution",
              "Boltzmann distribution"
            ],
            correctIndex: 1
          },
          {
            text: "Resistance in metals is mainly due to",
            options: [
              "Scattering by defects and lattice vibrations",
              "Scattering only by lattice vibrations",
              "Scattering only by defects",
              "Scattering by bound electrons"
            ],
            correctIndex: 2
          },
          {
            text: "Which statement about Fermi–Dirac distribution is false?",
            options: [
              "At E = EF, probability is 1/2 at any temperature",
              "At T = 0 K all levels up to EF are filled and above are empty",
              "At T > 0 K some above EF are partially filled, some below partially empty",
              "At T = 0 K some above EF are partially filled and some below are empty"
            ],
            correctIndex: 3
          },
          {
            text: "Examples of Fermions are",
            options: [
              "Electrons",
              "Photons",
              "Phonons",
              "Atoms"
            ],
            correctIndex: 0
          },
          {
            text: "Which assumptions of quantum free electron theory are true?\n(a) Energy values of conduction electrons are quantized.\n(b) Distribution follows Pauli principle.\n(c) Electrons move in constant potential but are confined.",
            options: [
              "(a) only",
              "(b) only",
              "(a) and (c)",
              "(a), (b) and (c)"
            ],
            correctIndex: 3
          },
          {
            text: "According to quantum theory, conductivity is due to electrons",
            options: [
              "Very close to Fermi level",
              "Much below Fermi level",
              "In valence band",
              "None of these"
            ],
            correctIndex: 0
          },
          {
            text: "Mobility of electrons in copper is 3.5×10⁻³ m²V⁻¹s⁻¹. For E = 2 V/m, drift velocity is",
            options: [
              "0.7×10⁻³ m/s",
              "7×10⁻³ m/s",
              "1.75×10⁻³ m/s",
              "7×10³ m/s"
            ],
            correctIndex: 1
          },
          {
            text: "Mobility in copper is 3×10³ m²V⁻¹s⁻¹. With e = 1.6×10⁻¹⁹ C, mₑ = 9.1×10⁻³¹ kg, mean collision time is",
            options: [
              "16.2×10⁻¹³ s",
              "1.7×10⁻¹⁵ s",
              "1.8×10⁻¹⁵ s",
              "17.06×10⁻¹⁵ s"
            ],
            correctIndex: 3
          },
          {
            text: "Using Fermi function, f(E) for (E − EF) = 0.01 eV at 200 K is",
            options: [
              "0.36",
              "0.64",
              "0.45",
              "0.55"
            ],
            correctIndex: 0
          },
          {
            text: "A silver wire has ρ = 1.54×10⁻⁸ Ωm, E = 1 V/cm, n = 5.8×10²⁸ m⁻³. Average drift velocity and mobility are approximately",
            options: [
              "(a) 0.3 m/s, (b) 10×10⁻³ m²/Vs",
              "(a) 0.7 cm/s, (b) 70×10⁻³ m²/Vs",
              "(a) 3.0 m/s, (b) 17×10⁻³ m²/Vs",
              "(a) 0.7 m/s, (b) 7×10⁻³ m²/Vs"
            ],
            correctIndex: 3
          },
          {
            text: "Magnetic lines cannot penetrate a superconductor. This is the",
            options: [
              "Isotopic effect",
              "BCS theory",
              "Meissner effect",
              "Silsbee’s effect"
            ],
            correctIndex: 2
          },
          {
            text: "Minimum current to destroy superconductivity is called",
            options: [
              "Induced current",
              "Critical current",
              "Eddy current",
              "Hall current"
            ],
            correctIndex: 1
          },
          {
            text: "In superconductivity, conductivity becomes",
            options: [
              "Zero",
              "Finite",
              "Infinite",
              "None of these"
            ],
            correctIndex: 2
          },
          {
            text: "In superconductors, temperature at which conductivity becomes infinite is called",
            options: [
              "Critical temperature",
              "Absolute temperature",
              "Mean temperature",
              "Crystallization temperature"
            ],
            correctIndex: 0
          },
          {
            text: "The superconducting state is perfectly ______ in nature.",
            options: [
              "Diamagnetic",
              "Paramagnetic",
              "Ferromagnetic",
              "Ferrimagnetic"
            ],
            correctIndex: 0
          },
          {
            text: "Binding energy of a Cooper pair is of order",
            options: [
              "10⁻³ eV",
              "10³ eV",
              "10⁻³ J",
              "10³ J"
            ],
            correctIndex: 0
          },
          {
            text: "Electron pairs in a superconductor are",
            options: [
              "Bosons",
              "Leptons",
              "Hydrons",
              "Fermions"
            ],
            correctIndex: 0
          },
          {
            text: "Transition to normal state at a critical magnetic field Hc occurs abruptly in",
            options: [
              "Type-I superconductor",
              "Type-II superconductor",
              "Both types",
              "Conductors"
            ],
            correctIndex: 0
          },
          {
            text: "Magnetic susceptibility χ in a superconductor is",
            options: [
              "Positive",
              "Zero",
              "Negative",
              "Infinite"
            ],
            correctIndex: 2
          },
          {
            text: "Hard superconductors are also called",
            options: [
              "Type-I",
              "Type-II",
              "Both types",
              "Conductors"
            ],
            correctIndex: 1
          },
          {
            text: "Silsbee’s rule gives relation between",
            options: [
              "Current and critical temperature",
              "Current and critical magnetic field",
              "Current and isotopic mass",
              "Critical current and critical magnetic field"
            ],
            correctIndex: 3
          }
        ],

        "Unit 4: Semiconductors": [
          {
            text: "Solids with high value of conductivity are called",
            options: [
              "Conductors",
              "Non-metal",
              "Insulator",
              "Semi-conductor"
            ],
            correctIndex: 0
          },
          {
            text: "Fermi level for a metal is",
            options: [
              "Highest level occupied at 0°C",
              "Average of all levels",
              "Highest level occupied at 0 K",
              "Sum of all electron energies"
            ],
            correctIndex: 2
          },
          // Q3 with formulas skipped (unreadable in text)
          {
            text: "The relationship between current density J and electric field E is",
            options: [
              "J = σE",
              "J = σ / E",
              "J = σ / 2E",
              "J = (1/σ)E"
            ],
            correctIndex: 0
          },
          {
            text: "Intrinsic semiconductors are",
            options: [
              "Pure semiconductor material",
              "Materials with zero energy gap",
              "Materials with more electrons than holes",
              "Locally available materials"
            ],
            correctIndex: 0
          },
          {
            text: "A pure semiconductor behaves as an insulator at 0 K because",
            options: [
              "No recombination of electrons and holes",
              "Drift velocity is very small",
              "No free electrons for conduction",
              "Electron energy is almost zero"
            ],
            correctIndex: 2
          },
          {
            text: "Which Fermi–Dirac statement is false?",
            options: [
              "At E = EF, probability is 1/2 at all temperatures",
              "At 0 K, all levels up to EF are filled and above are empty",
              "At T > 0 K, some levels above EF are partially filled and some below partially empty",
              "At 0 K, some levels above EF are partially filled and some below are empty"
            ],
            correctIndex: 3
          },
          {
            text: "Examples of Fermions are",
            options: [
              "Electrons",
              "Photons",
              "Phonons",
              "Atoms"
            ],
            correctIndex: 0
          },
          {
            text: "Using Fermi function, f(E) for (E − EF) = 0.01 eV at 200 K is",
            options: [
              "0.36",
              "0.64",
              "0.45",
              "0.55"
            ],
            correctIndex: 0
          },
          {
            text: "An elemental semiconductor is formed by ______ bonds.",
            options: [
              "Covalent",
              "Electrovalent",
              "Co-ordinate",
              "Ionic"
            ],
            correctIndex: 0
          },
          {
            text: "A semiconductor has ______ temperature coefficient of resistance.",
            options: [
              "Positive",
              "Zero",
              "Negative",
              "Infinite"
            ],
            correctIndex: 2
          },
          {
            text: "The most commonly used semiconductor is",
            options: [
              "Gallium",
              "Silicon",
              "Carbon",
              "Arsenide"
            ],
            correctIndex: 1
          },
          {
            text: "A semiconductor has generally ______ valence electrons.",
            options: [
              "2",
              "3",
              "6",
              "4"
            ],
            correctIndex: 3
          },
          {
            text: "Adding pentavalent impurity to pure semiconductor makes it",
            options: [
              "Insulator",
              "Intrinsic semiconductor",
              "p-type",
              "n-type"
            ],
            correctIndex: 3
          },
          {
            text: "Pentavalent impurity creates",
            options: [
              "Donor electrons",
              "Holes",
              "Valence electrons",
              "Bound electrons"
            ],
            correctIndex: 0
          },
          {
            text: "A pentavalent impurity has ______ valence electrons.",
            options: [
              "3",
              "5",
              "4",
              "6"
            ],
            correctIndex: 1
          },
          {
            text: "An n-type semiconductor is",
            options: [
              "Positively charged",
              "Negatively charged",
              "Electrically neutral",
              "None of these"
            ],
            correctIndex: 2
          },
          {
            text: "A trivalent impurity has ______ valence electrons.",
            options: [
              "4",
              "5",
              "6",
              "3"
            ],
            correctIndex: 3
          },
          {
            text: "Adding trivalent impurity to a semiconductor creates",
            options: [
              "Holes",
              "Donor electrons",
              "Valence electrons",
              "Bound electrons"
            ],
            correctIndex: 0
          },
          {
            text: "A hole in a semiconductor is",
            options: [
              "A free electron",
              "An electron vacancy",
              "A free proton",
              "A free neutron"
            ],
            correctIndex: 1
          },
          {
            text: "As doping of a pure semiconductor increases, bulk resistance",
            options: [
              "Remains same",
              "Increases",
              "Decreases",
              "Becomes zero"
            ],
            correctIndex: 2
          },
          {
            text: "In an intrinsic semiconductor, conduction is due to",
            options: [
              "Holes only",
              "Electrons only",
              "Both electrons and holes",
              "None of these"
            ],
            correctIndex: 2
          },
          {
            text: "When a pure semiconductor is heated, its resistance",
            options: [
              "Increases",
              "Decreases",
              "Remains same",
              "Cannot say"
            ],
            correctIndex: 1
          },
          {
            text: "In an intrinsic semiconductor, the number of free electrons",
            options: [
              "Equals number of holes",
              "Is greater than holes",
              "Is less than holes",
              "None of these"
            ],
            correctIndex: 0
          },
          {
            text: "At room temperature, an intrinsic semiconductor has",
            options: [
              "Holes only",
              "Electrons and holes",
              "Electrons only",
              "No carriers"
            ],
            correctIndex: 1
          },
          {
            text: "At absolute zero, an intrinsic semiconductor has",
            options: [
              "A few free electrons",
              "Many holes",
              "Many free electrons",
              "No holes and no free electrons"
            ],
            correctIndex: 3
          },
          {
            text: "Which is an indirect band gap semiconductor?",
            options: [
              "Germanium",
              "GaAs",
              "GaAsP",
              "Carbon"
            ],
            correctIndex: 0
          },
          {
            text: "Which of the following is a semiconductor?",
            options: [
              "Diamond",
              "Arsenic",
              "Phosphorous",
              "Gallium arsenide"
            ],
            correctIndex: 3
          },
          {
            text: "In an intrinsic semiconductor, Fermi level",
            options: [
              "Is at middle of forbidden gap",
              "Is near conduction band",
              "Is near valence band",
              "Can be anywhere in forbidden gap"
            ],
            correctIndex: 0
          },
          {
            text: "For silicon at 300 K, energy gap is",
            options: [
              "0.7 J",
              "1.1 J",
              "1.1 eV",
              "0.7 eV"
            ],
            correctIndex: 2
          },
          {
            text: "Forbidden gap of germanium is",
            options: [
              "0.7 J",
              "0.7 eV",
              "1.1 eV",
              "1.1 J"
            ],
            correctIndex: 1
          },
          {
            text: "In an N-type semiconductor, Fermi level is",
            options: [
              "Close to valence band",
              "In the middle of band gap",
              "Close to conduction band",
              "Anywhere"
            ],
            correctIndex: 2
          },
          {
            text: "Unit of mobility is",
            options: [
              "V/s",
              "m²/V·s",
              "m²/s",
              "J/K"
            ],
            correctIndex: 1
          },
          {
            text: "The energy gap in a semiconductor",
            options: [
              "Increases with temperature",
              "Does not change with temperature",
              "Decreases with temperature",
              "Is zero"
            ],
            correctIndex: 1
          },
          {
            text: "Donor impurity in semiconductor gives a",
            options: [
              "Wide band",
              "Narrow band",
              "Discrete level just below conduction band",
              "Discrete level just above valence band"
            ],
            correctIndex: 2
          },
          {
            text: "Hall effect is clearly visible in",
            options: [
              "Insulators",
              "Semiconductors",
              "Superconductors",
              "Non-metals"
            ],
            correctIndex: 1
          },
          {
            text: "Lorentz force expression (magnitude) is",
            options: [
              "BeV",
              "BV",
              "eV",
              "B"
            ],
            correctIndex: 0
          },
          {
            text: "Hall effect can be used to measure",
            options: [
              "Magnetic field intensity",
              "Mobility",
              "Carrier concentration",
              "All of these"
            ],
            correctIndex: 3
          },
          {
            text: "Which parameter cannot be found using Hall effect?",
            options: [
              "Type of semiconductor (p or n)",
              "Conductivity",
              "Carrier concentration",
              "Area of device"
            ],
            correctIndex: 3
          },
          {
            text: "In Hall effect, E is along X, velocity along Y. Direction of B is",
            options: [
              "X",
              "Y",
              "Z",
              "In XY plane"
            ],
            correctIndex: 2
          },
          {
            text: "If number of electrons in a semiconductor is 10²⁰, Hall coefficient is",
            options: [
              "0.625",
              "0.0625",
              "6.25",
              "62.5"
            ],
            correctIndex: 1
          },
          {
            text: "Conductivity of silicon doped with 10²¹ m⁻³ boron, μₕ = 0.048 m²/Vs, is",
            options: [
              "76.8/Ωm",
              "7.68/Ωm",
              "7.68 Ωm",
              "0.768/Ωm"
            ],
            correctIndex: 1
          },
          {
            text: "Resistivity of intrinsic Ge, nᵢ = 2.5×10¹⁹ m⁻³, μₑ = 0.38, μₕ = 0.18 m²/Vs is about",
            options: [
              "0.45/Ωm",
              "0.045 Ωm",
              "0.45 Ωm",
              "4.50 Ωm"
            ],
            correctIndex: 2
          },
          {
            text: "Sample thickness 1.2×10⁻⁴ m in B = 0.2 T, I = 100 mA, n = 10²³ m⁻³. Hall voltage is",
            options: [
              "0.123 V",
              "0.0123 V",
              "1.23 V",
              "0.0012 V"
            ],
            correctIndex: 1
          },
          {
            text: "Intrinsic Si, nᵢ = 1.1×10¹⁶ m⁻³, μₑ = 0.17, μₕ = 0.035 m²/Vs. Resistivity is",
            options: [
              "0.277×10³ Ωm",
              "27.7×10³ Ωm",
              "2.77×10³ Ωm",
              "0.0277×10³ Ωm"
            ],
            correctIndex: 2
          },
          {
            text: "GaAs has intrinsic conductivity 10⁻⁶ Ω⁻¹m⁻¹ at 20°C, μₑ = 0.88, μₕ = 0.04 m²/Vs. Number of electrons crossing gap is about",
            options: [
              "6.79×10³ m⁻³",
              "0.679×10³ m⁻³",
              "67.9×10³ m⁻³",
              "0.0679×10³ m⁻³"
            ],
            correctIndex: 0
          },
          {
            text: "Hall coefficient measurement enables determination of",
            options: [
              "Temperature coefficient and thermal conductivity",
              "Mobility and carrier concentration",
              "Fermi level and band gap",
              "Area of device"
            ],
            correctIndex: 1
          },
          {
            text: "If Hall coefficient is zero, the material is",
            options: [
              "Intrinsic semiconductor",
              "Extrinsic semiconductor",
              "Metal",
              "Insulator"
            ],
            correctIndex: 3
          },
          {
            text: "If magnetic field is reversed, Hall voltage",
            options: [
              "Becomes zero",
              "Changes direction with same magnitude",
              "Doubles",
              "Remains unchanged"
            ],
            correctIndex: 1
          },
          {
            text: "Hall voltage develops in a direction",
            options: [
              "Parallel to current",
              "Perpendicular to both current and magnetic field",
              "Along magnetic field",
              "Opposite to magnetic field"
            ],
            correctIndex: 1
          },
          {
            text: "At absolute zero, an intrinsic semiconductor behaves as",
            options: [
              "Insulator",
              "Superconductor",
              "n-type semiconductor",
              "p-type semiconductor"
            ],
            correctIndex: 0
          },
          {
            text: "In intrinsic semiconductors, number of electrons is ______ number of holes.",
            options: [
              "Equal to",
              "Greater than",
              "Less than",
              "None of these"
            ],
            correctIndex: 0
          },
          {
            text: "When a pure semiconductor is heated, its resistance",
            options: [
              "Goes up",
              "Goes down",
              "Remains same",
              "None of these"
            ],
            correctIndex: 1
          },
          {
            text: "Intrinsic semiconductor at room temperature has",
            options: [
              "Electrons",
              "Holes",
              "Both electrons and holes",
              "No carriers"
            ],
            correctIndex: 2
          },
          {
            text: "Carrier density in a pure semiconductor is proportional to",
            options: [
              "exp(-Eg/kT)",
              "exp(-2Eg/kT)",
              "exp(-Eg/kT²)",
              "exp(-Eg/2kT)"
            ],
            correctIndex: 3
          },
          {
            text: "In intrinsic semiconductors, conductivity is",
            options: [
              "σ = nₑ e μₑ",
              "σ = nₕ e μₕ",
              "σ = nᵢ e (μₑ + μₕ)",
              "nₑ e μₑ > nₕ e μₕ"
            ],
            correctIndex: 2
          },
          {
            text: "A semiconductor has generally ______ valence electrons.",
            options: [
              "2",
              "3",
              "4",
              "5"
            ],
            correctIndex: 2
          },
          {
            text: "A semiconductor has ______ temperature coefficient of resistance.",
            options: [
              "Positive",
              "Negative",
              "Both",
              "Infinite"
            ],
            correctIndex: 1
          },
          {
            text: "Which statement about Hall effect is true?",
            options: [
              "Cannot occur in semiconductors",
              "Occurs only in metals",
              "Gives concentration and type of carriers",
              "Observed only at very low temperatures"
            ],
            correctIndex: 2
          },
          {
            text: "Primary function of a solar cell is",
            options: [
              "Store solar energy chemically",
              "Reflect sunlight",
              "Convert sunlight directly to electrical energy",
              "Absorb and retain heat"
            ],
            correctIndex: 2
          }
        ]
      }

      // Other subjects (Calculus, Basic Electronics, ADLD, UHV, COI) are "coming soon"
    };

    // =========================
    //  CONFIG: SUBJECT BUTTONS
    // =========================
    const allSubjects = [
      "PSP",
      "Physics",
      "Calculus",
      "Basic Electronics",
      "ADLD",
      "UHV",
      "COI"
    ];

    // =========================
    //  STATE
    // =========================
    let currentSubject = null;
    let currentUnit = null;
    let currentQuestions = [];
    let questionOrder = [];
    let currentOrderIndex = 0;
    let questionsAnsweredOverall = 0;
    let questionsAnsweredInBatch = 0;
    let correctOverall = 0;
    let correctInBatch = 0;
    let batchNumber = 1;
    const BATCH_SIZE = 10;

    // =========================
    //  ELEMENTS
    // =========================
    const subjectButtonsContainer = document.getElementById("quiz-subject-buttons");
    const unitButtonsContainer = document.getElementById("quiz-unit-buttons");
    const unitPlaceholder = document.getElementById("unit-placeholder");
    const comingSoonSubjectEl = document.getElementById("coming-soon-subject");

    const quizCard = document.getElementById("quiz-card");
    const quizTitle = document.getElementById("quiz-title");
    const quizUnitLabel = document.getElementById("quiz-unit-label");
    const quizProgress = document.getElementById("quiz-progress");

    const questionText = document.getElementById("question-text");
    const optionsContainer = document.getElementById("options-container");

    const checkBtn = document.getElementById("check-btn");
    const nextBtn = document.getElementById("next-btn");
    const nextSetBtn = document.getElementById("next-set-btn");

    const feedbackEl = document.getElementById("quiz-feedback");
    const finalSummaryEl = document.getElementById("final-summary");

    // =========================
    //  UTILS
    // =========================
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    // =========================
    //  RENDER SUBJECTS & UNITS
    // =========================
    function renderSubjectButtons() {
      subjectButtonsContainer.innerHTML = "";
      comingSoonSubjectEl.classList.add("hidden");
      const subjects = allSubjects;

      subjects.forEach((subject) => {
        const hasUnits =
          quizData[subject] && Object.keys(quizData[subject]).length > 0;

        const btn = document.createElement("button");
        btn.className = "btn subject-btn";
        if (!hasUnits) {
          btn.classList.add("coming-soon");
        }
        btn.dataset.subject = subject;
        btn.textContent = subject + (hasUnits ? "" : " (Coming soon)");

        btn.addEventListener("click", () => {
          currentSubject = subject;
          currentUnit = null;
          resetState();
          hideQuiz();

          subjectButtonsContainer
            .querySelectorAll(".subject-btn")
            .forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");

          renderUnitButtons(hasUnits);
        });

        subjectButtonsContainer.appendChild(btn);
      });
    }

    function renderUnitButtons(hasUnitsForSubject) {
      unitButtonsContainer.innerHTML = "";
      if (unitPlaceholder) unitPlaceholder.remove();
      comingSoonSubjectEl.classList.add("hidden");

      if (!hasUnitsForSubject) {
        const p = document.createElement("p");
        p.style.fontSize = "0.9rem";
        p.style.color = "#6b7280";
        p.textContent = `Quizzes for ${currentSubject} are coming soon.`;
        unitButtonsContainer.appendChild(p);
        return;
      }

      const unitsObj = quizData[currentSubject] || {};
      const unitNames = Object.keys(unitsObj);

      if (unitNames.length === 0) {
        const p = document.createElement("p");
        p.style.fontSize = "0.9rem";
        p.style.color = "#6b7280";
        p.textContent = `Quizzes for ${currentSubject} are coming soon.`;
        unitButtonsContainer.appendChild(p);
        return;
      }

      unitNames.forEach((unitName) => {
        const questions = unitsObj[unitName] || [];
        const btn = document.createElement("button");
        btn.className = "btn chapter-btn";
        btn.textContent = questions.length
          ? unitName
          : `${unitName} (Coming soon)`;

        btn.addEventListener("click", () => {
          currentUnit = unitName;
          resetState();
          hideQuiz();

          unitButtonsContainer
            .querySelectorAll(".chapter-btn")
            .forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");

          if (!questions.length) {
            finalSummaryEl.style.display = "block";
            finalSummaryEl.textContent = `Quiz for "${unitName}" is coming soon.`;
            return;
          }

          startUnitQuiz();
        });

        unitButtonsContainer.appendChild(btn);
      });
    }

    // =========================
    //  QUIZ FLOW
    // =========================
    function resetState() {
      currentQuestions = [];
      questionOrder = [];
      currentOrderIndex = 0;
      questionsAnsweredOverall = 0;
      questionsAnsweredInBatch = 0;
      correctOverall = 0;
      correctInBatch = 0;
      batchNumber = 1;
      resetFeedback();
      finalSummaryEl.style.display = "none";
      finalSummaryEl.textContent = "";
      checkBtn.disabled = false;
      nextBtn.style.display = "none";
      nextSetBtn.style.display = "none";
    }

    function startUnitQuiz() {
      if (!currentSubject || !currentUnit) return;

      currentQuestions = quizData[currentSubject][currentUnit] || [];
      if (!currentQuestions.length) {
        finalSummaryEl.style.display = "block";
        finalSummaryEl.textContent = `Quiz for "${currentUnit}" is coming soon.`;
        return;
      }

      questionOrder = shuffle(
        Array.from({ length: currentQuestions.length }, (_, i) => i)
      );
      currentOrderIndex = 0;
      questionsAnsweredOverall = 0;
      questionsAnsweredInBatch = 0;
      correctOverall = 0;
      correctInBatch = 0;
      batchNumber = 1;

      quizCard.classList.remove("hidden");
      quizTitle.textContent = currentSubject;
      quizUnitLabel.textContent = currentUnit;
      finalSummaryEl.style.display = "none";
      nextSetBtn.style.display = "none";

      renderQuestion();
    }

    function renderQuestion() {
      resetFeedback();
      if (
        !currentQuestions.length ||
        currentOrderIndex < 0 ||
        currentOrderIndex >= currentQuestions.length
      ) {
        return;
      }

      const total = currentQuestions.length;
      const qIndex = questionOrder[currentOrderIndex];
      const q = currentQuestions[qIndex];

      quizProgress.textContent = `Q ${currentOrderIndex + 1} / ${total}`;
      questionText.textContent = q.text;

      optionsContainer.innerHTML = "";
      q.options.forEach((opt, index) => {
        const label = document.createElement("label");
        label.className = "quiz-option";

        const input = document.createElement("input");
        input.type = "radio";
        input.name = "quiz-option";
        input.value = index;

        const span = document.createElement("span");
        span.textContent = opt;

        label.appendChild(input);
        label.appendChild(span);
        optionsContainer.appendChild(label);
      });

      checkBtn.disabled = false;
      nextBtn.style.display = "none";
      nextSetBtn.style.display = "none";
    }

    function getSelectedOptionIndex() {
      const inputs = optionsContainer.querySelectorAll('input[name="quiz-option"]');
      for (const input of inputs) {
        if (input.checked) return parseInt(input.value, 10);
      }
      return null;
    }

    function lockOptions() {
      const inputs = optionsContainer.querySelectorAll('input[name="quiz-option"]');
      inputs.forEach((input) => {
        input.disabled = true;
      });
    }

    function resetFeedback() {
      feedbackEl.className = "";
      feedbackEl.style.display = "none";
      feedbackEl.textContent = "";
    }

    function showInfo(msg) {
      feedbackEl.className = "info";
      feedbackEl.textContent = msg;
      feedbackEl.style.display = "block";
    }

    function showCorrect(msg) {
      feedbackEl.className = "correct";
      feedbackEl.textContent = msg;
      feedbackEl.style.display = "block";
    }

    function showIncorrect(msg) {
      feedbackEl.className = "incorrect";
      feedbackEl.textContent = msg;
      feedbackEl.style.display = "block";
    }

    function hideQuiz() {
      quizCard.classList.add("hidden");
      resetFeedback();
      finalSummaryEl.style.display = "none";
    }

    function showBatchSummary(isFinal) {
      const total = currentQuestions.length;
      finalSummaryEl.style.display = "block";

      if (isFinal) {
        finalSummaryEl.textContent =
          `Unit complete. Total score: ${correctOverall} / ${total}.`;
      } else {
        finalSummaryEl.textContent =
          `Batch ${batchNumber} complete. ` +
          `Score this batch: ${correctInBatch} / ${questionsAnsweredInBatch}. ` +
          `Total so far: ${correctOverall} / ${questionsAnsweredOverall}.`;
      }
    }

    // =========================
    //  EVENT HANDLERS
    // =========================
    checkBtn.addEventListener("click", () => {
      const selectedIndex = getSelectedOptionIndex();
      if (selectedIndex === null) {
        showInfo("Please select an option first.");
        return;
      }

      const qIndex = questionOrder[currentOrderIndex];
      const q = currentQuestions[qIndex];

      if (selectedIndex === q.correctIndex) {
        correctOverall++;
        correctInBatch++;
        showCorrect("Correct!");
      } else {
        showIncorrect("Wrong. Correct answer: " + q.options[q.correctIndex]);
      }

      questionsAnsweredOverall++;
      questionsAnsweredInBatch++;

      lockOptions();
      checkBtn.disabled = true;

      const isLastQuestionOverall =
        currentOrderIndex === currentQuestions.length - 1;
      const batchLimitReached = questionsAnsweredInBatch >= BATCH_SIZE;

      if (!isLastQuestionOverall && !batchLimitReached) {
        nextBtn.style.display = "inline-block";
        nextSetBtn.style.display = "none";
      } else {
        nextBtn.style.display = "none";
        const isFinal = isLastQuestionOverall;
        showBatchSummary(isFinal);

        if (!isFinal) {
          nextSetBtn.textContent = "Next 10 Questions";
          nextSetBtn.dataset.mode = "nextBatch";
          nextSetBtn.style.display = "inline-block";
        } else {
          nextSetBtn.textContent = "Finish";
          nextSetBtn.dataset.mode = "finish";
          nextSetBtn.style.display = "inline-block";
        }
      }
    });

    nextBtn.addEventListener("click", () => {
      if (currentOrderIndex < currentQuestions.length - 1) {
        currentOrderIndex++;
        renderQuestion();
      }
    });

    nextSetBtn.addEventListener("click", () => {
      const mode = nextSetBtn.dataset.mode;
      if (mode === "nextBatch") {
        questionsAnsweredInBatch = 0;
        correctInBatch = 0;
        batchNumber++;
        finalSummaryEl.style.display = "none";
        nextSetBtn.style.display = "none";

        if (currentOrderIndex < currentQuestions.length - 1) {
          currentOrderIndex++;
          renderQuestion();
        }
      } else if (mode === "finish") {
        quizCard.classList.add("hidden");
        nextSetBtn.style.display = "none";
      }
    });

    // =========================
    //  INIT
    // =========================
    document.addEventListener("DOMContentLoaded", () => {
      renderSubjectButtons();
    });
  </script>
</body>
</html>
